const partners = [
  {
    name: "Tnex",
    logo: "images/tnex/tnex.png",
    benefits: [
      "✔️ Vay tiền chỉ cần CCCD",
      "✔️ Không chứng minh thu nhập, không thẩm định người thân",
      "✔️ Nhận ngay khoản vay chỉ trong 15 phút",
      "✔️ Lãi suất thấp nhất trên thị trường vay tín chấp",
      "✔️ Mức giải ngân đa dạng từ 3 - 10 triệu, dành cho mọi đối tượng",
    ],
    link: "https://shorten.asia/W2t1tsFY",
    guideSteps: [
      {
        img: "images/tnex/Step1.png",
        text: "<span>Bước 1:</span> Điền Họ Tên và số điện thoại sau đó ấn <strong>Đăng ký vay ngay</strong>.",
      },
      {
        img: "images/tnex/Step2.png",
        text: "<span>Bước 2:</span> Ấn <strong>Tải ứng dụng TNEX ngay</strong>.",
      },
      {
        img: "images/tnex/Step3.png",
        text: "<span>Bước 3:</span> Xác thực số điện thoại (không cần nhập mã giới thiệu).",
      },
      {
        img: "images/tnex/Step4.png",
        text: "<span>Bước 4:</span> Chọn mục vay tiêu dùng.",
      },
      {
        img: "images/tnex/Step5.png",
        text: "<span>Bước 5:</span> Khuyến khích trên 5M để được duyệt nhanh và nhập mã <strong>AT100</strong>.",
      },
      {
        img: "images/tnex/Step6.png",
        text: "<span>Bước 6:</span> Tiến hành đăng ký và xác thực thông tin.",
      },
      {
        img: "images/tnex/Step7.png",
        text: "<span>Bước 7:</span> Thông báo phê duyệt sẽ được gửi qua Email. Sau khi nhận được Email thì khách hàng quay lại app để ký hợp đồng và nhận khoản vay. (Thời gian phê duyệt tối đa 3 ngày).",
      },
      {
        img: "images/tnex/Note.png",
        text: "<strong>Lưu ý</strong> <p>1. Khách hàng có địa chỉ thường trú trên CMT/CCCD không nằm trong các tỉnh/thành phố sau: Hải Phòng, Sóc Trăng, Quảng Ninh, Bến Tre, Tây Ninh, Đắk Nông, Đắk Lắk, Gia Lai, Cà Mau, Điện Biên, Lai Châu, Sơn La, Tuyên Quang, Kon Tum, Yên Bái</p><p>2. Có nhu cầu vay thật và thu nhập từ 8 triệu/tháng trở lên.</p><p>3. Khách hàng có list danh bạ thật, không được để trống danh bạ và cho phép truy cập vào danh bạ khi đăng ký vay.</p>",
      },
    ],
  },
  {
    name: "Tnex Telesale",
    logo: "images/tnex/logo.png",
    benefits: [
      "✔️ Vay tiền chỉ cần CCCD",
      "✔️ Không chứng minh thu nhập, không thẩm định người thân",
      "✔️ Thẻ ghi nợ cực chất được giao tận tay, không cần phải đến ngân hàng",
      "✔️ Đảm bảo không có chi phí ẩn",
      "✔️ Mức giải ngân đa dạng từ 5 - 20 triệu, dành cho mọi đối tượng",
    ],
    link: "https://shorten.asia/gXkkUphu",
    guideSteps: [
      {
        img: "images/tnex/Step1.png",
        text: "<span>Bước 1:</span> Điền Họ Tên và số điện thoại sau đó ấn <strong>Đăng ký vay ngay</strong>.",
      },
      {
        img: "images/tnex/Step2.png",
        text: "<span>Bước 2:</span> Ấn <strong>Tải ứng dụng TNEX ngay</strong>.",
      },
      {
        img: "images/tnex/Step3.png",
        text: "<span>Bước 3:</span> Xác thực số điện thoại (không cần nhập mã giới thiệu).",
      },
      {
        img: "images/tnex/Step4.png",
        text: "<span>Bước 4:</span> Chọn mục vay tiêu dùng.",
      },
      {
        img: "images/tnex/Step5.png",
        text: "<span>Bước 5:</span> Khuyến khích trên 5M để được duyệt nhanh và nhập mã <strong>AT100</strong>.",
      },
      {
        img: "images/tnex/Step6.png",
        text: "<span>Bước 6:</span> Tiến hành đăng ký và xác thực thông tin.",
      },
      {
        img: "images/tnex/Step7.png",
        text: "<span>Bước 7:</span> Thông báo phê duyệt sẽ được gửi qua Email. Sau khi nhận được Email thì khách hàng quay lại app để ký hợp đồng và nhận khoản vay. (Thời gian phê duyệt tối đa 3 ngày).",
      },
      {
        img: "images/tnex/Note.png",
        text: "<strong>Lưu ý</strong> <p>1. Khách hàng có địa chỉ thường trú trên CMT/CCCD không nằm trong các tỉnh/thành phố sau: Hải Phòng, Sóc Trăng, Quảng Ninh, Bến Tre, Tây Ninh, Đắk Nông, Đắk Lắk, Gia Lai, Cà Mau, Điện Biên, Lai Châu, Sơn La, Tuyên Quang, Kon Tum, Yên Bái</p><p>2. Có nhu cầu vay thật và thu nhập từ 8 triệu/tháng trở lên.</p><p>3. Khách hàng có list danh bạ thật, không được để trống danh bạ và cho phép truy cập vào danh bạ khi đăng ký vay.</p>",
      },
    ],
  },
  {
    name: "Lotte Finace",
    logo: "images/lotte/logo.webp",
    benefits: [
      "✔️ Vay tiền chỉ cần CCCD",
      "✔️ Hạn mức vay cao lên đến 500tr",
      "✔️ Thời hạn vay dài từ 6-60 tháng",
      "✔️ Giải ngân nhanh, trong vòng 4h với các hồ sơ đạt yêu cầu",
      "✔️ Ưu tiên cán bộ công chức, viên chức, dân văn phòng, công nhân",
    ],
    link: "https://shorten.asia/gXkkUphu",
    guideSteps: [
      {
        img: "images/lotte/Step1.png",
        text: "Khách hàng điền đầy đủ thông tin sau đó ấn <strong>Đăng ký vay ngay</strong>.",
      },
      {
        img: "images/util/note.png",
        text: "<strong>Lưu ý</strong> <p>1. Khách hàng có độ tuổi từ 25 tới 60 tuổi, có thu nhập trên 7 triệu/tháng, có hợp đồng lao động chính thức từ 1 năm và thời gian làm việc từ 3 năm trở lên</p><p>2. Ưu tiên Khách hàng là cán bộ công chức, viên chức, dân văn phòng, công nhân và có nhu cầu vay từ 10 tới 500 triệu đồng trong thời hạn từ 6 tới 60 tháng</p><p>3. Ưu tiên: khách hàng nữ, có thu nhập trên 3 triệu/tháng, có nhu cầu vay từ 10 tới 100 triệu trong thời hạn từ 6 tới 36 tháng.</p>",
      },
    ],
  },
];

// Tạo card
const container = document.getElementById("partners");

partners.forEach((p, index) => {
  const card = document.createElement("div");
  card.className = "partner-card";
  card.innerHTML = `
    <div class="logo"><img src="${p.logo}" alt="${p.name}"></div>
    <ul>${p.benefits.map((b) => `<li>${b}</li>`).join("")}</ul>
    <a href="#" class="btn open-guide" data-index="${index}">Đăng ký vay ngay</a>
  `;
  container.appendChild(card);
});

// Modal logic
const modal = document.getElementById("guideModal");
const guideStep = document.getElementById("guide-step");
const prevBtn = document.getElementById("prevStep");
const nextBtn = document.getElementById("nextStep");
const closeBtn = document.querySelector(".modal .close");
const startBtn = document.getElementById("startRegister");

let currentStep = 0;
let currentPartner = null;

function showStep(stepIndex) {
  const step = currentPartner.guideSteps[stepIndex];
  guideStep.innerHTML = `
    <p>${step.text}</p>
    <img src="${step.img}" alt="Step ${stepIndex + 1}">
  `;

  // Ẩn bằng visibility để giữ layout
  prevBtn.classList.toggle("hidden-visibility", stepIndex === 0);
  nextBtn.classList.toggle(
    "hidden-visibility",
    stepIndex === currentPartner.guideSteps.length - 1
  );
  startBtn.classList.toggle(
    "hidden",
    stepIndex !== currentPartner.guideSteps.length - 1
  );
}

document.querySelectorAll(".open-guide").forEach((btn) => {
  btn.addEventListener("click", (e) => {
    e.preventDefault();
    const index = parseInt(btn.dataset.index);
    currentPartner = partners[index];
    currentStep = 0;
    showStep(currentStep);
    modal.classList.remove("hidden");
  });
});

nextBtn.onclick = () => {
  if (currentStep < currentPartner.guideSteps.length - 1) {
    currentStep++;
    showStep(currentStep);
  }
};

prevBtn.onclick = () => {
  if (currentStep > 0) {
    currentStep--;
    showStep(currentStep);
  }
};

closeBtn.onclick = () => {
  modal.classList.add("hidden");
};

startBtn.onclick = () => {
  window.open(currentPartner.link, "_blank");
  modal.classList.add("hidden");
};
